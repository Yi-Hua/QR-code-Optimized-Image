function Hvs = HVS(Im,N)
% [Eq.15]
% h[m,n] = __k___  ______________________1________________________
%           2*pi   ( k/2pi+(180m/pi*R*D)^2+(180n/pi*R*D)^2 )^(3/2)
% HVS: h[m,n], D = 9 inches, R = 150 dpi, (0.525, 3.91)


  [m,n,~] = size(Im);       Hvs = zeros(m,n);
%------------------------+------------------------+------------------------
  HSL = rgb2hsl(Im);      L = HSL(:,:,3);          G = sum(L(:))/N;
%--9 inches--------------+--150 dpi---------------+------------------------
  D = 9;                  R = 150;   
  ky = 0.525*log(G)+3.91; k = 1/ky;
for i = 1:m
    for j = 1:n
        Hvs(i,j) = (k/2*pi)/(k/2*pi+(180*j/pi*R*D)^2 + ((180*i/pi*R*D)^2)^(3/2));
    end
end
end


