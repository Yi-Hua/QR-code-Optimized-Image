function y = Output(x,Im,QR,Mda,Wa) 
% [] : RGB => HSL => HSL* => R*G*B* 
Lo = zeros(Wa);

% block B -----------------------------------------------------------------
Imb  =  Im(2*Wa+1:3*Wa, 2*Wa+1:3*Wa , 1:3);
QRb  =  QR(2*Wa+1:3*Wa, 2*Wa+1:3*Wa);
Mdab = Mda(2*Wa+1:3*Wa, 2*Wa+1:3*Wa); 
% RGB => HSL--------------------------------------------------------------
HSL = rgb2hsl(Imb);
lt = Yout(x,Imb,QRb,Mdab);
% argmin | f(x) - lt |
for k = 1:Wa^2
    Lo(k) = fL(Imb,lt,k); 
end

HSL(:,:,3) = Lo;

y = hsl2rgb(HSL);
end

% Change central block [] : RGB => HSL => HSL* => R*G*B* 
% -------------------------------------------------------------------------
% Window ij       5*Wa
%            __ __ __ __ __
%           |__|__|__|__|__|      
%           |__|__|__|__|__|  2*Wa+1  
%    5*Wa   |__|__|[]|__|__|    :           []: central block B
%           |__|__|__|__|__|   3*Wa
%           |__|__|__|__|__|               
%            2*Wa+1 : 3*Wa


% xn ----------------------------------------------------------------------
%    ______________________________
%   | W(1,1) |    ....    | W(1,t2)|        x1  = x(1,1)
%   |      __|_____       |        |        x2  = x(1,2)
%   |_____|__|     |      |________|         :       :
%   |     | W(3,3) |               |   xn =  :    x(1,t2)  = [ x((i-1)*t2 + j) ]
%   |     |________|               |         :    x(2, 1)
%   |                              |         :        :
%   |               ...    ________|         :    x(2,t2)
%   |                     |W(t1,t2)|         :        :
%   |                     |        |     xt1*t2 = x(t1,t2)
%   |_____________________|________| 

